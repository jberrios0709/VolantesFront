<app-navbar></app-navbar>
<div class="content slide data fadeInAnimated fastAnimated"> 
  <div class="row">
    <div class="col-12 text-center">
      <h4>Pedidos</h4>
    </div>
  </div>
  
  <div *ngIf="orders.lentgh === 0"><h1>Buscando data {{orders.lentgh}}</h1></div>
  <table class="table  table-hover" *ngIf="orders.lentgh != 0">
    <thead class="thead-dark">
      <tr (click)="test()">
        <th scope="col">Número de cliente</th>
        <th scope="col">Cliente</th>
        <th scope="col">Producto</th>
        <th scope="col">Gramage</th>
        <th scope="col">Entrega</th>
        <th scope="col">Tamaño</th>
        <th scope="col">Espacios</th>
        <th scope="col">Diseño</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of orders; let i = index" class="fadeInAnimated" style="cursor:pointer" data-toggle="modal" data-target="#exampleModal" (click)="selectOrder(i)">
        <th scope="row">{{order.branch.client.id}}</th>
        <td>{{order.branch.client.name}}</td>
        <td>{{order.product}}</td>
        <td>{{order.garnet}}</td>
        <td>{{order.time_delivery}}</td>
        <td>{{order.size}}</td>
        <td>{{order.spaces}}</td>
        <td>{{parseDesign(order.design)}}</td>
      </tr>
    </tbody>
  </table>


    <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h4 class="modal-title text-center" id="exampleModalLabel" >Datos del pedido</h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" *ngIf="orderSelect">
          <table class="table" *ngIf="request != 'next'">
            <thead class="thead-dark">
              <tr>
                <th scope="col">Número de cliente</th>
                <th scope="col">Cliente</th>
                <th scope="col">Producto</th>
                <th scope="col">Gramage</th>
                <th scope="col">Entrega</th>
                <th scope="col">Tamaño</th>
                <th scope="col">Espacios</th>
                <th scope="col">Diseño</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">{{order.branch.client.id}}</th>
                <td>{{order.branch.client.name}}</td>
                <td>{{order.product}}</td>
                <td>{{order.garnet}}</td>
                <td>{{order.time_delivery}}</td>
                <td>{{order.size}}</td>
                <td>{{order.spaces}}</td>
                <td>{{parseDesign(order.design)}}</td>
              </tr>
            </tbody>
          </table>

          <div class="offset-md-4 col-md-4" *ngIf="request != 'next'">
            <form [formGroup]="forma">
              <div class="row">
                <div class="col-6">
                  <h1>Diseñado:  </h1>
                </div>
                <div class="col-6 spacing">
                  <select formControlName="design" [ngClass]="{'check' : forma.value.design === '1' || forma.value.design === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
                <div class="col-6">
                  <h1>Envío 1:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="send1" [ngClass]="{'check' : forma.value.send1 === '1' || forma.value.send1 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
                <div class="col-6">
                  <h1>Correción 1:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="correction1" [ngClass]="{'check' : forma.value.correction1 === '1' || forma.value.correction1 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>

                <div class="col-6">
                  <h1>Envío 2:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="send2" [ngClass]="{'check' : forma.value.send2 === '1' || forma.value.send2 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
                <div class="col-6">
                  <h1>Correción 2:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="correction2" [ngClass]="{'check' : forma.value.correction2 === '1' || forma.value.correction2 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>

                <div class="col-6">
                  <h1>Envío 3:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="send3" [ngClass]="{'check' : forma.value.send3 === '1' || forma.value.send3 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
                <div class="col-6">
                  <h1>Correción 3:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="correction3" [ngClass]="{'check' : forma.value.correction3 === '1' || forma.value.correction3 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>

                <div class="col-6">
                  <h1>Envío 4:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="send4" [ngClass]="{'check' : forma.value.send4 === '1' || forma.value.send4 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
                <div class="col-6">
                  <h1>Correción 4:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="correction4" [ngClass]="{'check' : forma.value.correction4 === '1' || forma.value.correction4 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>

                <div class="col-6">
                  <h1>Envío 5:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="send5" [ngClass]="{'check' : forma.value.send5 === '1' || forma.value.send1 === 5}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>                   
                  </select>
                </div>

                <div class="col-6">
                  <h1>Correción 5:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="correction5" [ngClass]="{'check' : forma.value.correction5 === '1' || forma.value.correction5 === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option> 
                  </select>
                </div>

                <div class="col-6">
                  <h1>Aprovado:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="approved" [ngClass]="{'check' : forma.value.approved === '1' || forma.value.approved === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>                    
                  </select>
                </div>

                <div class="col-6">
                  <h1>Responsabilidad:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="responsibility" [ngClass]="{'check' : forma.value.responsibility === '1' || forma.value.responsibility === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>                    
                  </select>
                </div>

                <div class="col-6">
                  <h1>Finalizado:  </h1>
                </div>
                <div class="col-6  spacing">
                  <select formControlName="finish" [ngClass]="{'check' : forma.value.finish === '1' || forma.value.finish === 1}">
                    <option *ngFor="let op of selects" [value]=op.value>{{op.text}}</option>
                  </select>
                </div>
              </div> 
            </form>
          </div>
          
              
          
          <div *ngIf="request === 'good'" class="alert alert-success fade fastAnimated" role="alert" style="margin-top:10px">
              Datos guardados exitosamente.
          </div>
          <div *ngIf="request === 'next'" class="alert alert-success fade fastAnimated" role="alert" style="margin-top:10px">
            Datos guardados exitosamente. El pedido ha sido enviado al area de impresión.
          </div>
          <div *ngIf="request === 'error'" class="alert alert-danger fade fastAnimated" role="alert" style="margin-top:10px">
              Error en la operacion.
          </div>
        </div>
        <div class="modal-footer">
          <!--Buttons-->
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
          <button type="button" class="btn btn-primary" *ngIf="forma.valid && (!forma.value.finish || !forma.value.responsibility || forma.value.finish === '0' || !forma.value.responsibility === '0') && request != 'next'" (click)="update()">Guardar Cambios</button>
          <button type="button" class="btn btn-success" *ngIf="forma.valid && (forma.value.finish === 1 || forma.value.finish === '1') && (forma.value.responsibility === 1 || forma.value.responsibility === '1')" (click)="update()">Imprimir</button>
        </div>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>

